paper.install(window);var tool1,tool2,tool3,tool4,tool6,cx,cy,path,selectedItem,group,isResize=!1,hasHandle=!1,handles={topLeft:0,bottomRight:0,clear:function(){this.topLeft=0,this.bottomRight=0}},textToolStatus={isDragging:!1,isResizing:!1,currentPath:null,currentText:null,clear:function(){this.isDragging=!1,this.currentPath=null,this.currentText=null}};window.onload=function(){function t(){var t=project.getItems({"class":Item}),e=project.getItems({data:{type:"textbox"}});for(var o in t)t[o].bounds.selected=!1;for(var o in e)e[o].children.handleMove.visible=!1,e[o].children.handleResize.visible=!1;textToolStatus.clear()}function e(t,e){return textItem=new PointText(e.add(20)),textItem.content=t,textItem}paper.setup("myCanvas");var o={segments:!0,fill:!0,tolerance:5};tool3=new Tool,tool3.onMouseUp=function(o){if(textToolStatus.isDragging){var n=textToolStatus.currentPath.bounds.topLeft,a=e("Enter your text here",n),l=new Group(textToolStatus.currentPath,a),i=new Path.Circle({center:textToolStatus.currentPath.bounds.topLeft,radius:7,opacity:.55,strokeColor:"gray",fillColor:"white",name:"handleMove",visible:!1}),s=new Path.Circle({center:textToolStatus.currentPath.bounds.bottomRight,radius:7,opacity:.55,strokeColor:"gray",fillColor:"white",name:"handleResize",visible:!1});l.data={type:"textbox",isSelected:!1},l.appendTop(i),l.appendTop(s),a.onDoubleClick=function(t){var e=prompt("Enter your text","Hello Paper.js");null!=e&&(this.content=e)},l.onMouseDown=function(e){t(),this.children.handleMove.visible=!0,this.children.handleResize.visible=!0},t(),l.children.handleMove.visible=!0,l.children.handleResize.visible=!0,textToolStatus.clear()}},tool3.onMouseDown=function(t){cx=t.point.x,cy=t.point.y;var e=new Rectangle(t.point,new Size(1,1));path=new Path.Ellipse(e),path.fillColor=new Color("#f5b8b8")},tool3.onMouseDrag=function(t){textToolStatus.isDragging=!0,path.remove();var e=Math.min(t.point.x,cx),o=Math.min(t.point.y,cy),n=Math.abs(t.point.x-cx),a=Math.abs(t.point.y-cy),l=new Rectangle(e,o,n,a),i=new Rectangle({point:l.point,size:l.size}),s=new Size(5,5);path=new Path.RoundRectangle(i,s),path.fillColor=new Color("#f5b8b8"),path.data={type:"bbox"},textToolStatus.currentPath=path},tool6=new Tool,tool6.onMouseDrag=function(t){if("handleMove"===selectedItem.name){var e=selectedItem.parent;e.position=e.position.add(t.delta)}if("handleResize"===selectedItem.name&&textToolStatus.isResizing&&(selectedItem.position=selectedItem.position.add(t.delta),textToolStatus.currentPath)){textToolStatus.currentPath.remove();var o=Math.min(t.point.x,cx),n=Math.min(t.point.y,cy),a=Math.abs(t.point.x-cx),l=Math.abs(t.point.y-cy),i=new Rectangle(o,n,a,l),s=new Rectangle({point:i.point,size:i.size}),r=new Size(5,5);path=new Path.RoundRectangle(s,r),path.opacity=.45,path.fillColor=new Color("#f5b8b8"),path.data={type:"bbox"},textToolStatus.currentPath=path}},tool6.onMouseUp=function(t){if(textToolStatus.isResizing){var e=selectedItem.parent;textToolStatus.currentPath.opacity=1,e.appendBottom(textToolStatus.currentPath),textToolStatus.clear(),textToolStatus.isResizing=!1}},tool6.onMouseDown=function(e){var n=project.hitTest(e.point,o);if(n||t(),n){var a=null;if(selectedItem=path=n.item,"handleResize"===selectedItem.name){console.log("You're hitting : "+selectedItem.name);var l=selectedItem.parent;cx=l.children.handleMove.position.x,cy=l.children.handleMove.position.y,console.log("handleMove: "+l.children.handleMove.position),a=l.getItems({data:{type:"bbox"}}),textToolStatus.currentPath=path=a[0],textToolStatus.isResizing=!0}console.log("text: "+n.item._content),console.log("Parent: "+selectedItem.parent),console.log("selected point: "+selectedItem.bounds.topLeft),console.log("selected data: ",selectedItem.data)}},window.searchGroup=function(){var t=project.getItems({data:{type:"textbox"}});for(var e in t)t[e].children.handleMove.visible=!1,t[e].children.handleResize.visible=!1;console.log("Group count: "+t.length)}};
